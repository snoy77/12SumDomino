<!DOCTYPE html>
<html>
<head>
	<title>alterDomino</title>
	<link rel="stylesheet" type="text/css" href="style.css">
</head>
<body onload="NewGame()">
	<style type="text/css">
		.startButton{
			width: 100px;
			height: 50px;

			margin: 0 auto;
			border: 5px;
			border-color: red;
			border-style: solid;

			transition: 0.5s;
		}
		.startButton:hover{
			background-color: yellow;
		}
		.startButton:active{
			background-color: blue;
		}
	</style>
	<div class="startButton" onclick="NewGame()"></div>
	<div style="margin-top: 40vh; margin-left: auto; margin-right: auto;">
	
	<div id="0" class="domino">
		<img id="domino0_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino0_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="1" class="domino">
		<img id="domino1_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino1_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="2" class="domino">
		<img id="domino2_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino2_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="3" class="domino">
		<img id="domino3_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino3_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="4" class="domino">
		<img id="domino4_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino4_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="5" class="domino">
		<img id="domino5_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino5_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="6" class="domino">
		<img id="domino6_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino6_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="7" class="domino">
		<img id="domino7_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino7_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="8" class="domino">
		<img id="domino8_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino8_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="9" class="domino">
		<img id="domino9_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino9_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="10" class="domino">
		<img id="domino10_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino10_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="11" class="domino">
		<img id="domino11_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino11_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="12" class="domino">
		<img id="domino12_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino12_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="13" class="domino">
		<img id="domino13_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino13_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="14" class="domino">
		<img id="domino14_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino14_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="15" class="domino">
		<img id="domino15_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino15_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="16" class="domino">
		<img id="domino16_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino16_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="17" class="domino">
		<img id="domino17_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino17_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="18" class="domino">
		<img id="domino18_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino18_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="19" class="domino">
		<img id="domino19_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino19_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="20" class="domino">
		<img id="domino20_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino20_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="21" class="domino">
		<img id="domino21_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino21_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="22" class="domino">
		<img id="domino22_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino22_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="23" class="domino">
		<img id="domino23_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino23_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="24" class="domino">
		<img id="domino24_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino24_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="25" class="domino">
		<img id="domino25_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino25_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="26" class="domino">
		<img id="domino26_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino26_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="27" class="domino">
		<img id="domino27_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino27_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	</div>

	<script type="text/javascript">
		function mouseEnter(object){		
			object.style.backgroundColor = "red";
		}
		function mouseOut(object){
			if(selectedDominosId[0] != null){
				if(selectedDominosId[0].id == object.id){
					object.style.backgroundColor = "#657488";
					return;
				}
			}
			if(selectedDominosId[1] != null){
				if(selectedDominosId[1].id == object.id){
					object.style.backgroundColor = "#657488";
					return;
				}
			}
			if(Dominos[findDominoInList(object.id)].IsDominoUp){
				object.style.backgroundColor = "white";
				return;
			}
			object.style.backgroundColor = "#424242"
		}
	</script>
	<script type="text/javascript">
		function hh(string){
			return "|"+string;
		}

		let countSelectedDomino = 0;
		let selectedDominosId = new Array(null,null);
		let Dominos = [
			Domino(0,1,6),
			Domino(1,0,5),
			Domino(2,1,6),
			Domino(3,1,6),
			Domino(4,1,6),
			Domino(5,0,5),
			Domino(6,0,5),
			Domino(7,1,6),
			Domino(8,0,5),
			Domino(9,1,6),
			Domino(10,1,6)];
		function RebildControllers(){
			for(let i = 0; i < 27; i = i + 1){
				let object = document.getElementById(i);
				object.style.backgroundColor = "";
				object.onclick = {};
				object.onmouseenter = {};
				object.onmouseleave = {};
			}
		}
		function NewGame(){
			//Ранломизация доминошек, и присвоение контроллерам событий
			function MixDomino(){
				Dominos = [];
				let freeDigit = [[0],			//0
								[0,1],			//1
								[0,1,2],		//2
								[0,1,2,3],		//3
								[0,1,2,3,4],	//4
								[0,1,2,3,4,5],	//5
								[0,1,2,3,4,5,6]];//6
				function getRand(max){
					return Math.floor(Math.random() * Math.floor(max));
				}
				for(let i = 0; i < 28; i = i + 1){
					let a = getRand(freeDigit.length);
					let down = true;
					while(freeDigit[a] == null){
						if(down){
							a = a + 1;
						}
						else{
							a = a - 1;
						}
						if(a == freeDigit.length){
							down = false;
						}
					}
					let b = getRand(freeDigit[a].length);
					Dominos.push(Domino(i, a, freeDigit[a][b]));
					freeDigit[a] = removeAt(freeDigit[a],b);
					if(freeDigit[a].length == 0){
						freeDigit[a] = null;
					}
				}
				console.log("is load");
			}
			MixDomino();
			selectedDominosId = [null, null];
			countSelectedDomino = 0;
		}
		function Domino(name, valPanelOne, valPanelTwo){
			let object = {
		 		Name: name,
		 		PanelOneValue: valPanelOne,
		 		PanelTwoValue: valPanelTwo,
		 		Value: valPanelOne + valPanelTwo,
		 		IsDominoUp: false,
		 		UpDomino: function(){
		 			let PanelOneName = "domino" + this.Name + "_panel_1";
		 			let PanelTwoName = "domino" + this.Name + "_panel_2";

		 			let PanelOneSrc = "dominoPanel_" + this.PanelOneValue + ".png";
		 			let PanelTwoSrc = "dominoPanel_" + this.PanelTwoValue + ".png";

		 			document.getElementById(PanelOneName).src = PanelOneSrc;
		 			document.getElementById(PanelTwoName).src = PanelTwoSrc;

		 			this.IsDominoUp = true;
		 		}
		 	}
		 	let PanelOneName = "domino" + object.Name + "_panel_1";
		 	let PanelTwoName = "domino" + object.Name + "_panel_2";
		 	document.getElementById(PanelOneName).src = "dominoPanel_0.png";
		 	document.getElementById(PanelTwoName).src = "dominoPanel_0.png";

		 	let htmlElement = document.getElementById(object.Name);
		 	htmlElement.style.backgroundColor = "#424242";
		 	htmlElement.style.display = "inline-block";
		 	htmlElement.onclick = function(event) { dominoSelect(event.currentTarget)};
		 	htmlElement.onmouseenter = function(event){ mouseEnter(event.currentTarget);};
		 	htmlElement.onmouseleave = function(event){ mouseOut(event.currentTarget);};
		 	return object;
		}
		function findDominoInList(dominoId){
			let index = 0;
			while(dominoId != Dominos[index].Name){
				index++;
			}
			return index;
		}
		function removeAt(list, index){
			let result = [];
			for(let i = 0; i < list.length; i++){
				if(i != index){
					result.push(list[i]);	
				}
			}
			return result;
		}
		function dominoSelect(object){
			if(Dominos[findDominoInList(object.id)].IsDominoUp){
				//Выбираем домино
				object.style.backgroundColor = "#657488";
				selectedDominosId[countSelectedDomino] = object;
	
				countSelectedDomino += 1;

				//Сколько выбрано джминох
				if(countSelectedDomino == 2){
					//проверка на сумму доминох
					if(Dominos[findDominoInList(selectedDominosId[0].id)].Value + Dominos[findDominoInList(selectedDominosId[1].id)].Value == 12){
						selectedDominosId[0].style.display = 'none';
						selectedDominosId[1].style.display = 'none';
						selectedDominosId[0].onclick = () => {};
						selectedDominosId[1].onclick = () => {};
						selectedDominosId[0].onmouseenter = () => {};
						selectedDominosId[1].onmouseenter = () => {};
						selectedDominosId[0].onmouseleave = () => {};
						selectedDominosId[1].onmouseleave = () => {};
						
						Dominos = removeAt(Dominos, findDominoInList(selectedDominosId[0].id));
						Dominos = removeAt(Dominos, findDominoInList(selectedDominosId[1].id));
						//Если сумма равна 12: спрятать элементы, и, желательно, удалить из списка доминох
					}
					else{
						//Если сумма НЕ равна 12: перекрашиваем доминохи обратно
						selectedDominosId[0].style.backgroundColor = "white";
						selectedDominosId[1].style.backgroundColor = "white";
					}
					//Очищаем список выбраных доминох
					countSelectedDomino = 0;
					selectedDominosId = [null, null];
				}
			}
			else{
				function canOpenDomino(id){
					if(id != 0){
						if(Dominos[id-1].IsDominoUp){
							return false;
						}
					}
					if(id != Dominos.length-1){
						if(Dominos[id+1].IsDominoUp){
							return false;
						}
					}

					let checkIndex = id+1;
					while(checkIndex != Dominos.length){
						if(Dominos[checkIndex].IsDominoUp){
							return true;
						}
						checkIndex = checkIndex + 1;
					}
					if(id == 0){
						return true;
					}
					if(id == 1){
						return false;
					}
					else if(Dominos[id-2].IsDominoUp){
						return true;
					}
				}	
				if(canOpenDomino(findDominoInList(object.id))){
					Dominos[findDominoInList(object.id)].UpDomino();
				}
			}
			console.log("|элементов в стеке: "+countSelectedDomino);
		}
		function setStartData(dominoId){
			function DominoExsist(){
				
			}
			let panelsWith = new Array(6,6,6,6,6,6,6);
			Dominos ;	
		}	
	</script>
</body>
</html>