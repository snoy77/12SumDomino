<!DOCTYPE html>
<html>
<head>
	<title>alterDomino</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	
	<script type="text/javascript">
		function hh(string){
			return "|"+string;
		}
		let countSelectedDomino = 0;
		let selectedDominosId = new Array(null,null);
		let Dominos = [Domino(0,1,6), Domino(1,0,5), Domino(2,3,4), Domino(3,1,6), Domino(4,0,5), Domino(5,3,4), Domino(6,1,6), Domino(7,0,5), Domino(8,3,4), Domino(9,1,6)];
		let Dominos = {
			'0': Domino(0,1,6),
			'1': Domino(1,0,5),
			'2': Domino(2,3,4),
			'3': Domino(3,1,6),
			'4': Domino(4,0,5),
			'5': Domino(5,3,4),
			'6': Domino(6,1,6),
			'7': Domino(7,1,6),
			'8': Domino(8,1,6),
			'9': Domino(9,1,6),
			'10': Domino(10,1,6),
			'11': Domino(11,1,6),
			'12': Domino(12,1,6),
			'13': Domino(13,1,6),
			'14': Domino(14,1,6),
			'15': Domino(15,1,6),
			'16': Domino(16,1,6),
			'17': Domino(17,1,6),
			'18': Domino(18,1,6),
			'19': Domino(19,1,6),
			'20': Domino(20,1,6),
			'21': Domino(21,1,6),
			'22': Domino(22,1,6),
			'23': Domino(23,1,6),
			'24': Domino(24,1,6),
			'25': Domino(25,1,6),
			'26': Domino(26,1,6),
			'27': Domino(27,1,6),
		}
		function Domino(name, valPanelOne, valPanelTwo){
			return {
		 		Name: name,
		 		PanelOneValue: valPanelOne,
		 		PanelTwoValue: valPanelTwo,
		 		Value: valPanelOne + valPanelTwo,
		 		IsDominoUp: false,
		 		UpDomino: function(){
		 			let PanelOneName = "domino" + this.Name + "_panel_1";
		 			let PanelTwoName = "domino" + this.Name + "_panel_2";

		 			let PanelOneSrc = "dominoPanel_" + this.PanelOneValue + ".png";
		 			let PanelTwoSrc = "dominoPanel_" + this.PanelTwoValue + ".png";

		 			console.log(">Обработка открытия доминошки: ");
		 			console.log(hh(PanelOneSrc));
		 			console.log(hh(PanelTwoSrc));
		 			console.log(hh("domino" + this.Name + "_panel_1"));
		 			console.log(hh(document.getElementById("domino" + this.Name + "_panel_1")));
		 			document.getElementById(PanelOneName).src = PanelOneSrc;
		 			document.getElementById(PanelTwoName).src = PanelTwoSrc;

		 			this.IsDominoUp = true;
		 		}
		 	}
		}

		function dominoSelect(id){
			console.log(">Обработка выбора домино: "+id);

			if(Dominos[id].IsDominoUp){
				//Выбираем домино
				document.getElementById(id).style.backgroundColor = "#657488";
				selectedDominosId[countSelectedDomino] = id;
				console.log("|Элемент: "+selectedDominosId[countSelectedDomino]);
	
				countSelectedDomino += 1;

				if(countSelectedDomino == 2){
					//проверка на сумму доминох
					if(Dominos[selectedDominosId[0]].Value + Dominos[selectedDominosId[1]].Value == 12){
						document.getElementById(selectedDominosId[0]).style.display = 'none';
						document.getElementById(selectedDominosId[1]).style.display = 'none';
						Dominos = Dominos.slice(Number(selectedDominosId[0]),Number(selectedDominosId[0])+1);
						Dominos = Dominos.slice(Number(selectedDominosId[1]),Number(selectedDominosId[1])+1);
						//Если сумма равна 12: спрятать элементы, и, желательно, удалить из списка доминох
					}
					else{
						//Если сумма НЕ равна 12: перекрашиваем доминохи обратно
						document.getElementById(selectedDominosId[0]).style.backgroundColor = "white";
						document.getElementById(selectedDominosId[1]).style.backgroundColor = "white";
					}
					//Очищаем список выбраных доминох
					countSelectedDomino = 0;
					selectedDominosId = [null, null];
				}
			}
			else{
				function canOpenDomino(id){
					let curId = 0;
					id = Number(id);
					function findIn
					while(Dominos[curId].Name != id){
						curId++;
					}
					id = curId;


				
					//объявление проверяемого индекса
				
					//проверка стоит ли домино рядом с открытми доминохами - если да - вернуть ложь
					if(id != 0){
						if(Dominos[id-1].IsDominoUp == true){
							return false;
						}
					}
					if(Dominos[id+1].IsDominoUp){
						return false;
					}
					//проверка есть ли впереди открытые домино
					let haveOpenDominoInRight = false;
					let checkId = id+2;
					while(checkId < Dominos.length){
						if(Dominos[checkId].IsDominoUp){
							haveOpenDominoInRight = true;
						}
						checkId++;
					}
					if(haveOpenDominoInRight){
						return true;
					}
					else{
						if(id == 0 || id == 1){
							return true;
						}
						else if(Dominos[id-2].IsDominoUp){
							return true;
						}
					}
				}	
				
				//Если спереди доминох больше нет, то открыть можно доминоху +2 от последней откртой доминохи
				//Если между доминохой А и Б имеется большое расстояние, то открыть доминоху С можно любую межжду ними, которая не приближается к любой из концов на расстояние 1 от домино
				if(canOpenDomino(id)){
					Dominos[id].UpDomino();
				}
			}
			console.log("|элементов в стеке: "+countSelectedDomino);
		}
		function setStartData(dominoId){
			function DominoExsist(){
				
			}
			let panelsWith = new Array(6,6,6,6,6,6,6);
			Dominos ;	
		}
		
	</script>
	<script type="text/javascript">
		function mouseEnter(id){		
			document.getElementById(id).style.backgroundColor = "red";
		}
		function mouseOut(id){
			if(selectedDominosId[0] == id || selectedDominosId[1] == id){
				document.getElementById(id).style.backgroundColor = "#657488";
			}
			else if(Dominos[id].IsDominoUp){
				document.getElementById(id).style.backgroundColor = "white";
			}
			else{
				document.getElementById(id).style.backgroundColor = "#424242"
			}
		}
	</script>
</head>
<body>

	<div id="0" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino0_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino0_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="1" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino1_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino1_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="2" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino2_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino2_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="3" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino3_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino3_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="4" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino4_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino4_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="5" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino5_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino5_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="6" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino6_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino6_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="7" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino7_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino7_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="8" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino8_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino8_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="9" class="domino" onclick="dominoSelect(this.id)" onmouseenter="mouseEnter(this.id)" onmouseleave="mouseOut(this.id)">
		<img id="domino9_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino9_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<script type="text/javascript">
		function hh(string){
			return "|" + string;
		}
		console.log("Стартовые данные:")
		console.log(hh(countSelectedDomino));

		//Проверка доминошки
		let aa = Dominos[1];
		console.log(">Проверка открытия доминошки: " + aa.Name);
		console.log(hh("Панель первая равна: " + aa.PanelOneValue));
		console.log(hh("Панель вторая равна: " + aa.PanelTwoValue));
		console.log(hh("Сумма: " + aa.Value));
		console.log(hh("Доминоха открыта: " + aa.IsDominoUp));
		//aa.UpDomino();
		//console.log(hh("Доминоха открыта: " + aa.IsDominoUp));
		//============================
	</script>
</body>
</html>