<!DOCTYPE html>
<html>
<head>
	<title>alterDomino</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	
	<script type="text/javascript">
		function hh(string){
			return "|"+string;
		}

		let countSelectedDomino = 0;
		let selectedDominosId = new Array(null,null);
		let Dominos = [
			Domino(0,1,6),
			Domino(1,0,5),
			Domino(2,3,4),
			Domino(3,1,6),
			Domino(4,0,5),
			Domino(5,3,4),
			Domino(6,1,6),
			Domino(7,1,6),
			Domino(8,1,6),
			Domino(9,1,6)]
		function Domino(name, valPanelOne, valPanelTwo){
			return {
		 		Name: name,
		 		PanelOneValue: valPanelOne,
		 		PanelTwoValue: valPanelTwo,
		 		Value: valPanelOne + valPanelTwo,
		 		IsDominoUp: false,
		 		UpDomino: function(){
		 			let PanelOneName = "domino" + this.Name + "_panel_1";
		 			let PanelTwoName = "domino" + this.Name + "_panel_2";

		 			let PanelOneSrc = "dominoPanel_" + this.PanelOneValue + ".png";
		 			let PanelTwoSrc = "dominoPanel_" + this.PanelTwoValue + ".png";

		 			document.getElementById(PanelOneName).src = PanelOneSrc;
		 			document.getElementById(PanelTwoName).src = PanelTwoSrc;

		 			this.IsDominoUp = true;
		 		}
		 	}
		}
		function findDominoInList(dominoId){
			let index = 0;
			while(dominoId != Dominos[index].Name){
				index++;
			}
			return index;
		}
		function dominoSelect(object){
			if(Dominos[findDominoInList(object.id)].IsDominoUp){
				//Выбираем домино
				object.style.backgroundColor = "#657488";
				selectedDominosId[countSelectedDomino] = object;
	
				countSelectedDomino += 1;

				//Сколько выбрано джминох
				if(countSelectedDomino == 2){
					//проверка на сумму доминох
					if(Dominos[findDominoInList(selectedDominosId[0].id)].Value + Dominos[findDominoInList(selectedDominosId[1].id)].Value == 12){
						selectedDominosId[0].style.display = 'none';
						selectedDominosId[1].style.display = 'none';
						selectedDominosId[0].onclick = () => {};
						selectedDominosId[1].onclick = () => {};
						selectedDominosId[0].onmouseenter = () => {};
						selectedDominosId[1].onmouseenter = () => {};
						selectedDominosId[0].onmouseleave = () => {};
						selectedDominosId[1].onmouseleave = () => {};
						function removeAt(list, index){
							let result = [];
							for(let i = 0; i < list.length; i++){
								if(i != index){
									result.push(list[i]);	
								}
							}
							return result;
						}
						Dominos = removeAt(Dominos, findDominoInList(selectedDominosId[0].id));
						Dominos = removeAt(Dominos, findDominoInList(selectedDominosId[1].id));
						//Если сумма равна 12: спрятать элементы, и, желательно, удалить из списка доминох
					}
					else{
						//Если сумма НЕ равна 12: перекрашиваем доминохи обратно
						selectedDominosId[0].style.backgroundColor = "white";
						selectedDominosId[1].style.backgroundColor = "white";
					}
					//Очищаем список выбраных доминох
					countSelectedDomino = 0;
					selectedDominosId = [null, null];
				}
			}
			else{
				function canOpenDomino(id){
					if(id != 0){
						if(Dominos[id-1].IsDominoUp){
							return false;
						}
					}
					if(id != Dominos.length-1){
						if(Dominos[id+1].IsDominoUp){
							return false;
						}
					}

					let checkIndex = id+1;
					while(checkIndex != Dominos.length){
						if(Dominos[checkIndex].IsDominoUp){
							return true;
						}
						checkIndex = checkIndex + 1;
					}
					if(id == 0){
						return true;
					}
					if(id == 1){
						return false;
					}
					else if(Dominos[id-2].IsDominoUp){
						return true;
					}

				}	
				
				//Если спереди доминох больше нет, то открыть можно доминоху +2 от последней откртой доминохи
				//Если между доминохой А и Б имеется большое расстояние, то открыть доминоху С можно любую межжду ними, которая не приближается к любой из концов на расстояние 1 от домино
				if(canOpenDomino(findDominoInList(object.id))){
					Dominos[findDominoInList(object.id)].UpDomino();
				}
			}
			console.log("|элементов в стеке: "+countSelectedDomino);
		}
		function setStartData(dominoId){
			function DominoExsist(){
				
			}
			let panelsWith = new Array(6,6,6,6,6,6,6);
			Dominos ;	
		}
		
	</script>
	<script type="text/javascript">
		function mouseEnter(object){		
			object.style.backgroundColor = "red";
		}
		function mouseOut(object){
			if(selectedDominosId[0] != null){
				if(selectedDominosId[0].id == object.id){
					object.style.backgroundColor = "#657488";
					return;
				}
			}
			if(selectedDominosId[1] != null){
				if(selectedDominosId[1].id == object.id){
					object.style.backgroundColor = "#657488";
					return;
				}
			}
			if(Dominos[findDominoInList(object.id)].IsDominoUp){
				object.style.backgroundColor = "white";
				return;
			}
			object.style.backgroundColor = "#424242"
		}
	</script>
</head>
<body>

	<div id="0" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino0_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino0_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="1" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino1_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino1_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="2" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino2_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino2_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="3" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino3_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino3_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="4" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino4_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino4_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="5" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino5_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino5_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="6" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino6_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino6_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="7" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino7_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino7_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="8" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino8_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino8_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	<div id="9" class="domino" onclick="dominoSelect(this)" onmouseenter="mouseEnter(this)" onmouseleave="mouseOut(this)">
		<img id="domino9_panel_1" class="dominoPanelUp" src="dominoPanel_0.png">
		<img id="domino9_panel_2" class="dominoPanelDown" src="dominoPanel_0.png">
	</div>
	
	<script type="text/javascript">
		function hh(string){
			return "|" + string;
		}
		console.log("Стартовые данные:")
		console.log(hh(countSelectedDomino));

		//Проверка доминошки
		let aa = Dominos[1];
		console.log(">Проверка открытия доминошки: " + aa.Name);
		console.log(hh("Панель первая равна: " + aa.PanelOneValue));
		console.log(hh("Панель вторая равна: " + aa.PanelTwoValue));
		console.log(hh("Сумма: " + aa.Value));
		console.log(hh("Доминоха открыта: " + aa.IsDominoUp));
		//aa.UpDomino();
		//console.log(hh("Доминоха открыта: " + aa.IsDominoUp));
		//============================
	</script>
</body>
</html>